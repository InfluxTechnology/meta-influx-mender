
# Mender update support

INHERIT += "rm_work"
INHERIT += "mender-full"

MENDER_ARTIFACT_NAME = "image_smart.4.0"

DISTRO_FEATURES:append = " systemd"
VIRTUAL-RUNTIME_init_manager = "systemd"
DISTRO_FEATURES_BACKFILL_CONSIDERED = "sysvinit"
VIRTUAL-RUNTIME_initscripts = ""

MENDER_SERVER_URL = "https://hosted.mender.io"
MENDER_TENANT_TOKEN = "eyJhbGciOiJSUzI1NiIsImtpZCI6MCwidHlwIjoiSldUIn0.eyJqdGkiOiJiYWZkODFjZC1jN2NkLTQxY2ItOTU3Yi01ZGYzZTZhYjBiMGYiLCJzdWIiOiI1MmEyMmUyZS03OGQzLTQ2MmItYjkzYy1mZDc1YmVmOTE4ZWMiLCJleHAiOjE3NTEyNjQzMTcsImlhdCI6MTc1MDY1OTUxNywibWVuZGVyLnRlbmFudCI6IjY4NTAyNmI3MTFlYjhjODM1OGZlYjIxMSIsIm1lbmRlci51c2VyIjp0cnVlLCJpc3MiOiJldS5ob3N0ZWQubWVuZGVyLmlvIiwic2NwIjoibWVuZGVyLioiLCJtZW5kZXIucGxhbiI6ImVudGVycHJpc2UiLCJtZW5kZXIudHJpYWwiOnRydWUsIm1lbmRlci5hZGRvbnMiOlt7Im5hbWUiOiJjb25maWd1cmUiLCJlbmFibGVkIjp0cnVlfSx7Im5hbWUiOiJ0cm91Ymxlc2hvb3QiLCJlbmFibGVkIjp0cnVlfSx7Im5hbWUiOiJtb25pdG9yIiwiZW5hYmxlZCI6dHJ1ZX1dLCJuYmYiOjE3NTA2NTk1MTd9.KtRbpBA53LWUokcOzxKHuyz042O2UBCLF454ZMmEVUIhe0OFgmC2GwdW8F7KalPgFg0R6_sAE0qJv3RJavirutQgMQ9K9LXt36OySV_6EZ0qbxem0BygRpa4lrxOO7dQuq727pj2ovQNNULTBm7xifO1SmAgsza8yCCR4gyWMbzsziFCEniiaUpD7z2GMx-nDQsxixJLX7Ts3pmOo-4nLCg6c9lCtUG7hnyI95mY0rYW23WKVkCUnURyMrNvkwo0hHEaoLZzj-rffGYFDkh8dFQqgMonr-F_onPomzkXWiqf3qc8lSI6fFgBD0hGSrSnZaJbfn93dJ4tX-eAcD01o2OkRseB8iiu6nQEWZD55g8r6wSIIHT8nZkKSqL6RIQZa6e5npZGckAxMNY7Mk1utb28EXo6hSujJGAEWFJeLgrbv1vccZzCK1qaOQf53xW8ZGWnhV99eAR4DezJKkiyS6JvFe94dUmvIEokSXwnVUfF7fhv4NjqoRuhnAHxmlpm"

#MENDER_DEMO_HOST_IP_ADDRESS = "192.168.0.100"

#MENDER_SERVER_URL = "https://docker.mender.io"
#FILESEXTRAPATHS:prepend:pn-mender := "<DIRECTORY-CONTAINING-server.crt>:"
#SRC_URI:append:pn-mender = " file://server.crt"

MENDER_FEATURES_ENABLE:append = " mender-uboot mender-image-sd"
MENDER_FEATURES_DISABLE:append = " mender-grub mender-image-uefi"

PREFERRED_PROVIDER:u-boot-inf = "u-boot-fw-utils-mender-auto-provided"
IMAGE_FSTYPES:remove = "tar.bz2 ext4 sdcard.bz2"

IMAGE_BOOT_FILES:append = "u-boot-${MACHINE}.bin"
MENDER_IMAGE_BOOTLOADER_FILE = "imx-boot"

MENDER_IMAGE_BOOTLOADER_BOOTSECTOR_OFFSET:imx8mm-smart = "66"

do_image_sdimg[depends] += "imx-boot:do_deploy"

MENDER_STORAGE_DEVICE:imx8mm-smart = "/dev/mmcblk2"
MENDER_BOOT_PART_SIZE_MB = "64"
MENDER_STORAGE_TOTAL_SIZE_MB = "7456"

MENDER_DATA_PART_SIZE_MB = "512"

MENDER_STORAGE_DEVICE = "/dev/mmcblk2"

MENDER_ROOTFS_PART_A = "/dev/mmcblk2p2"
MENDER_ROOTFS_PART_B = "/dev/mmcblk2p3"
MENDER_BOOT_PART = "/dev/mmcblk2p1"
MENDER_DATA_PART = "/dev/mmcblk2p4"

PREFERRED_PROVIDER_u-boot-fw-utils = "u-boot-inf-fw-utils"
